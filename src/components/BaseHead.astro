---
const { canonicalURL, title, description, publishedDate, modifiedDate, articleType, author, image } = Astro.props;
const defaultCanonical = "https://cinematen.be/";
const finalCanonical = canonicalURL || defaultCanonical;

const defaultTitle = "Film & TV Reviews en Nieuws";
const defaultDescription = "Cinematen.be houdt je vinger aan de pols met het meest actuele nieuws uit de film- en seriewereld, inclusief de laatste ontwikkelingen uit Hollywood. Ontdek previews, trailers, recensies en exclusieve interviews. Blijf op de hoogte van alles wat actueel is op het grote en kleine scherm.";

const finalTitle = title || defaultTitle;
const finalDescription = description || defaultDescription;

const formatDateForMeta = (dateString) => {
    if (!dateString) return null;
    const date = new Date(dateString);
    return isNaN(date.getTime()) ? null : date.toISOString();
};

const formattedPublishedDate = formatDateForMeta(publishedDate);
const formattedModifiedDate = formatDateForMeta(modifiedDate);
---
<meta charset="utf-8" />
<meta content="width=device-width, initial-scale=1" name="viewport" />
<title>{finalTitle}</title>
<meta content={finalDescription} name="description" />
<meta name="google-site-verification" content="Ue-nOWKl8b37dpA_44eTIqresdKx1GF8BO1BEfSXwg4" />

<!-- Canonical URL -->
<link rel="canonical" href={finalCanonical} />

<!-- Open Graph / Twitter -->
<meta content={finalTitle} property="og:title" />
<meta content={finalDescription} property="og:description" />
<meta content="./images/Cinematelogotrans.png" property="og:image" />
<meta content={articleType || "website"} property="og:type" />
<meta content={finalTitle} property="twitter:title" />
<meta content={finalDescription} property="twitter:description" />
<meta content="/images/Cinematelogotrans.png" property="twitter:image" />
<meta content="summary_large_image" name="twitter:card" />
{formattedPublishedDate && <meta content={formattedPublishedDate} property="article:published_time" />}
{formattedModifiedDate && <meta content={formattedModifiedDate} property="article:modified_time" />}
{author && <meta content={author} property="article:author" />}

<!-- Favicon -->
<link href="/images/favicon.ico" rel="shortcut icon" type="image/x-icon" />
<link href="/images/webclip.png" rel="apple-touch-icon" />

<!-- Preconnect to image CDN -->
<link rel="preconnect" href="https://login.wabliefteru.be" />
<link rel="dns-prefetch" href="https://login.wabliefteru.be" />

<!-- Preload self-hosted fonts and logo -->
<link rel="preload" href="/fonts/rubik-variable.woff2" as="font" type="font/woff2" crossorigin />
<link rel="preload" as="image" href="/images/LogoCleanSmaller.png" type="image/png" />

<!-- Critical CSS with self-hosted fonts -->
<style>
    @font-face {
        font-family: 'Rubik';
        font-style: normal;
        font-weight: 400 700;
        font-display: swap;
        src: url('/fonts/rubik-variable.woff2') format('woff2');
    }
    @font-face {
        font-family: 'Rubik Mono One';
        font-style: normal;
        font-weight: 400;
        font-display: swap;
        src: url('/fonts/rubik-mono-one.woff2') format('woff2');
    }
    * {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }
    html, body, .page-wrapper, .content, .nieuws-section, .nieuws-title, .container, .w-layout-grid, .content-left, .content-right, .header_content, .nav-container, .nav-content, .main-nav, .menu-toggle, .nav-links, .next-button {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
    }
    body {
        font-family: 'Rubik', Arial, sans-serif;
        background: #181A2A;
        color: #fff;
    }
    .nieuws-title {
        font-size: 3rem;
        font-weight: 700;
        margin-bottom: 1rem;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
        padding: 0 1rem;
    }
    .w-layout-grid {
        display: grid;
        grid-template-columns: 1fr 350px;
        gap: 2rem;
    }
    @media (max-width: 900px) {
        .w-layout-grid {
            grid-template-columns: 1fr;
        }
        .content-right {
            margin-top: 2rem;
        }
    }
    .next-button {
        display: inline-block !important;
        padding: 20px 40px !important;
        background-color: #2E58AE !important;
        color: white !important;
        text-decoration: none !important;
        border-radius: 16px !important;
        margin-top: 24px !important;
        transition: background-color 0.3s ease;
        width: 100% !important;
        text-align: center !important;
        box-sizing: border-box !important;
    }
    .next-button:hover {
        background-color: #254a94 !important;
    }
    .next-button .title-medium {
        color: white !important;
        font-weight: 500 !important;
        font-size: 20px !important;
    }
</style>

<!-- Main stylesheet -->
<link href="/style.css" rel="stylesheet" />

<!-- Webflow touch detection -->
<script>
    document.documentElement.className += " w-mod-js";
    if ("ontouchstart" in window) document.documentElement.className += " w-mod-touch";
</script>

<!-- Google Analytics (deferred to not block rendering) -->
<script>
    window.addEventListener('load', function() {
        var s = document.createElement('script');
        s.src = 'https://www.googletagmanager.com/gtag/js?id=G-KZ3KYRB0T1';
        s.async = true;
        document.head.appendChild(s);
        s.onload = function() {
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-KZ3KYRB0T1');
        };
    });
</script>

<!-- Structured Data -->
{articleType === "article" ? (
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "Article",
  "headline": finalTitle,
  "description": finalDescription,
  "url": finalCanonical,
  ...(formattedPublishedDate && { "datePublished": formattedPublishedDate }),
  ...(formattedModifiedDate && { "dateModified": formattedModifiedDate }),
  ...(author && { "author": { "@type": "Person", "name": author } }),
  ...(image && { "image": image }),
  "publisher": {
    "@type": "Organization",
    "name": "Cinematen",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cinematen.be/images/Cinematelogotrans.png"
    }
  }
})}></script>
) : (
<script type="application/ld+json" set:html={JSON.stringify({
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "Cinematen.be",
  "url": "https://cinematen.be/",
  "description": "Film & TV Reviews en Nieuws door Yorrick & Maarten",
  "publisher": {
    "@type": "Organization",
    "name": "Cinematen",
    "logo": {
      "@type": "ImageObject",
      "url": "https://cinematen.be/images/Cinematelogotrans.png"
    }
  }
})}></script>
)}
